#!/usr/bin/env bash

# mostly stolen from: https://github.com/mathiasbynens/dotfiles/blob/master/.osx

# # disable press-and-hold
# defaults write -g ApplePressAndHoldEnabled -bool false

# set the icon size of Dock items
defaults write com.apple.dock tilesize -int 44

# lock Dock size
defaults write com.apple.dock size-immutable -bool true

# font smoothing (0-3, 3 is default)
# go back to defaults: defaults delete NSGlobalDomain AppleFontSmoothing
# defaults write NSGlobalDomain AppleFontSmoothing -int 1

# expand save panel by default
defaults write NSGlobalDomain NSNavPanelExpandedStateForSaveMode -bool true
defaults write NSGlobalDomain NSNavPanelExpandedStateForSaveMode2 -bool true

# expand print panel by default
defaults write NSGlobalDomain PMPrintingExpandedStateForPrint -bool true
defaults write NSGlobalDomain PMPrintingExpandedStateForPrint2 -bool true

# save to disk (not to iCloud) by default
defaults write NSGlobalDomain NSDocumentSaveNewDocumentsToCloud -bool false

# save screenshots in Dropbox
defaults write com.apple.screencapture location ~/Documents/Dropbox/Screenshots/

# disable Sudden Motion Sensor (default - 1)
sudo pmset -a sms 0 &> /dev/null

# enable trim 10.10.4+
if system_profiler SPSerialATADataType | grep 'TRIM' | grep -q 'No'; then
  read -r -p "Enble trim? (y/n) " RESP

  if [ "$RESP" = "y" ]; then
    sudo trimforce enable
  fi
fi

# kill affected apps
for app in "Dock" "Finder" "SystemUIServer"
do
  killall "$app" > /dev/null 2>&1
done
echo "$(tput setaf 1)Done. Note that some of these changes require a logout/restart to take effect.$(tput sgr0)"
